<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Properties of the score function | Chase A. Fleming </title> <meta name="author" content="Chase A. Fleming"> <meta name="description" content="some more notes on a paper by D. Shlyakhtenko"> <meta name="keywords" content="academic-website, mathematics, math-blog"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://flemingchase.github.io/drafts/2025-01-08-score-function/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span>Chase</span> A. Fleming </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/writings/">writings </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Properties of the score function</h1> <p class="post-meta"> Created in January 07, 2025 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2025   ·   <i class="fa-solid fa-hashtag fa-sm"></i> math statistics </p> </header> <article class="post-content"> <div id="markdown-content"> \[\begin{aligned} f(Z^{(k)}_{N+1} : {Z^{(r)}_{N+1}}_{r\neq k}) &amp;= (N+1)^{1/2}f\left( \sum_{j=1}^{N+1} X^{(k)}_{j} : {Z_{N+1}^{(r)}}_{r\neq k} \right) \\ &amp;= E_{M}\left((N+1)^{1/2}f\left(\sum_{i\neq j} X^{(k)}_{i} : \left\{ \sum_{i\neq j} X^{(r)}_{i}\right\}_{r\neq k}, \{X^{(r)}_{j}\}^{n}_{r=1} \right)\right)\\ &amp;= (N+1)^{1/2}E_{M}f\left(\sum_{i\neq j} X^{(k)}_{i} : \left\{\sum_{i\neq j} X^{(r)}_{i}\right\}_{r \neq k}\right) \end{aligned}\] <p>These were not immediate to us. So, we will justify each equality symbol in this proof. Before, we begin, let’s state the setting.</p> <h3 id="background">Background</h3> <p>Let \(\{(X^{(1)}_{j}, \ldots, X^{(n)}_{j})\}_{j=1,2,3,\ldots}\) be a sequence of \(n\)-tuples of random variables where each \(X_{i}^{(k)}\) lives inside some fixed operator algebra \(A\). Moreoever, assume that for each \(i,k \in \{1,2,3,\ldots\}, i\neq k\) the \(n\)-tuples \((X^{(1)}_{i},\ldots,X^{n}_{i})\) and \((X^{(1)}_{k},\ldots,X^{(n)}_{k})\) are independent and identically distrubted with finite second moments.</p> <p>We can visualize this as placing these random variables in an \(n \times \{1,2,3,\ldots\}\) matrix:</p> \[\begin{bmatrix} X^{(1)}_{1} &amp; X^{(2)}_{1} &amp; \ldots &amp; X^{(n)}_{1} \\ X^{(1)}_{2} &amp; X^{(2)}_{2} &amp; \ldots &amp; X^{(n)}_{2} \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\ X^{(1)}_{k} &amp; X^{(2)}_{k} &amp; \ldots &amp; X^{(n)}_{k} \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \end{bmatrix}\] <p>where each row, considered as an \(n\)-tuple is independent and identitcally distrubted from any other row.</p> <p>Next, we define new elements, the \(Z^{(k)}_{N}\). For every \(1 \leq k \leq n\) and \(N \in \{1,2,3,\ldots\}\), let</p> \[Z^{(k)}_{N} = \frac{1}{\sqrt{N}}\sum_{i=1}^{N} X^{(k)}_{i} = \frac{X_{1}^{(k)} + X^{(k)}_{2} + \ldots + X^{(k)}_{N}}{\sqrt{N}}\] <p>So, we can construct a new \(n\times \{1,2,3,\ldots\}\) matrix</p> \[\begin{bmatrix} Z^{(1)}_{1} &amp; Z^{(2)}_{1} &amp; \ldots &amp; Z^{(n)}_{1} \\ Z^{(1)}_{2} &amp; Z^{(2)}_{2} &amp; \ldots &amp; Z^{(n)}_{2} \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\ Z^{(1)}_{k} &amp; Z^{(2)}_{k} &amp; \ldots &amp; Z^{(n)}_{k} \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \end{bmatrix}\] <p>where the \((N,k)\)th entry in the above matrix, \(Z^{(k)}_{N}\) is the statistically normalized sum of the first \(N\) elements in the \(k\)th row of the original matrix.</p> <p>Next, we define this score function \(f\). For a fixed \(n\)-tuple of random variables \((X^{(1)}, X^{(2)}, \ldots, X^{(n)})\), define the score function with respect the \(j\)th variable as</p> \[f_{j} = f(X^{(j)}: X^{(1)}, \ldots, \hat{X}^{(j)}, \ldots, X^{(n)}) = -\frac{\partial p/\partial x_{j}}{p}\] <p>Where \(p\) is the joint densitiy function of the random variables \(X^{(1)}, \ldots X^{(n)}\).</p> <p>Finally, we restate two important lemmas from the paper.</p> <p><strong>Lemma 3</strong> <em>Assume that \(X\) is independent from \(Y^{(1)}, \ldots, Y^{(n)}\). Then one has the equality</em></p> <p>\(f(Y^{(j)}:Y^{(1)}, \ldots, \hat{Y}^{(j)}, \ldots Y^{(n)}, X) = f(Y^{(j)}: Y^{(1)}, \ldots, \hat{Y}^{(j)},\ldots, Y^{(n)})\).</p> <p>Essentially, this lemma states that score function is unchanged for an \(n\)-tuple of random variables if you consider an \(n+1\)-tuple where the random variable appended is independent from all previous random variables. The proof is immediate from definition of joint density and the product rule.</p> <p><strong>Lemma 4</strong> <em>Assume that \(\{X^{(k)}_{j}\}, 1\leq k \leq n, j= 1, 2,3, \ldots\) are random variables. Then, for each \(j = 1,2,3,\ldots, N+1\) and each \(1 \leq k \leq n\) we have the equality</em></p> \[f\left( \sum_{i=1}^{N+1} X^{(k)}_{i} : \left\{ \sum_{i=1}^{N+1} X^{(r)}_{i} \right\}_{r\neq k} \right) = E_{M} f\left( \sum_{i\neq j}^{N+1} X^{(k)}_{i} : \left\{ \sum_{i\neq j}^{N+1} X^{(r)}_{i} \right\}_{r\neq k}, \{X^{(r)}_{j}\}_{r=1}^{n}\right)\] <p><em>where \(M = W^{\star}\left( \left\{ \sum_{i=1}^{N+1} X^{(r)}_{i} \right\}_{r=1}^{n} \right)\).</em></p> <p>Lemma \(4\) at first glance seems very difficult to parse. So, let’s unpack it. Fix some \(1 \leq j &lt; N+1\). Let’s do some variable replacement. Let</p> \[Y^{(k)} = \sum_{i=1}^{N+1} X^{(k)}_{i} \text{and}\] <p>and</p> \[Y^{(k)\prime} = \sum_{i\neq j}^{N+1} X^{(k)}_{i}\] <p>With this replacement, we see that \(Y^{(k)}\) is just the sum of the first \(N+1\) random variables in the \(k\)th column, and \(Y^{(k)\prime}\) is the sum of the first \(N+1\) random variables in the \(k\)th column excluding the \(j\)th row entry.</p> <p>We may now restate lemma \(4\) as</p> \[f(Y^{(k)} : Y^{(1)}, \ldots, \hat{Y}^{(k)}, \ldots, Y^{(n)}) = E_{M} f(Y^{(k)\prime} : Y^{(1)\prime}, \ldots, \hat{Y}^{(k)\prime}, \ldots, Y^{(k)\prime}, X^{(1)}_{j}, \ldots, X^{(n)}_{j})\] <p>where \(M\) is the smallest subalgebra containing all the \(Y^{(k)}\)s.</p> <p>Then, in words, lemma 4 then says that the score of \(Y^{(k)}\) with respect to the joint distribution of \(Y^{(1)},\ldots, Y^{(n)}\) is equal to the conditional expectation with respect to the smallest subalgebra containing all the \(Y^{(k)}\)s of the score of \(Y^{(k)\prime}\) with respect to the joint distrubtion of \(Y^{(1)\prime},\ldots, Y^{(n)\prime}, X^{(1)}_{j}, \ldots, X^{(n)}_{j}\) (see my previous <a href="/blog/2025/conditional-expectation/"> blog</a> on conditional expectation in this context).</p> <p>We are now ready to justify each of the three equalities. So, let’s state the assumptions of lemma \(5\).</p> <p><strong>Lemma 5</strong> <em>Let \((X^{(1)}_{j}, \ldots, X^{(n)}_{j}), j=1, 2, 3, \ldots\) be a sequence of \(n\)-tuples so that these tuples of independent and identitically distrubuted and have finite second moments. Let</em></p> \[Z^{(k)}_{N} = X^{(k)}_{1} + \ldots + X^{(k)}_{N}/ \sqrt{N}\] <h3 id="first-equality">First equality</h3> <p>Let us compute the left and right hand side of the equality. Let \(f_{k}\) be the density of the random variable \(X^{(k)}_{1}\). Note that by the assumptions, that \(f_{k}\) is also the density of \(X^{(k)}_{j}\) for all \(j=1, 2, 3, \ldots\). Then, the density of \(Z^{(k)}_{N+1}\) is given by</p> \[p_{N+1}^{(k)}(z_{k}) = (N+1)^{1/2}(f_{1}^{\star(N+1)})((N+1)^{1/2}z) = (N+1)^{1/2}(f_{1} \star \ldots \star f_{1})((N+1)^{1/2}z_{k})\] <p>where the convolution is taken \(N+1\). See <a href="https://en.wikipedia.org/wiki/Convolution_of_probability_distributions" rel="external nofollow noopener" target="_blank">this</a> and <a href="https://math.stackexchange.com/a/1689639/220841&gt;" rel="external nofollow noopener" target="_blank">this</a> for justification.</p> <p>Thus, the joint density function for \(Z_{N+1}^{(1)}, \ldots, Z^{(n)}_{N+1}\) is given by</p> \[p(z_{1},\ldots, z_{n}) = \prod_{i=1}^{n} p_{N+1}^{(i)}(z_{i})\] <p>as each column is independent.</p> <p><strong>Left hand side</strong></p> <p>Therefore, we can compute the score with respect to \(Z_{N+1}^{(k)}\) as</p> \[\begin{aligned} f(Z_{N+1}^{(k)}: Z^{(1)}, \ldots, \hat{Z}^{(k)}_{N+1}, \ldots, Z^{(k)}_{N+1}) &amp;= - \frac{\partial p / \partial z_{j}}{p}\\ &amp;= -\frac{1}{\prod_{i=1}^{n} p_{N+1}^{(i)}(z_{i})} \frac{\partial}{\partial z_{k}} \prod_{i=1}^{n} p_{N+1}^{(i)}(z_{i}) \\ &amp;= -\frac{1}{\prod_{i=1}^{n} p_{N+1}^{(i)}} \frac{\partial p_{N+1}^{(k)}(z_{k})}{\partial z_{k}} \prod_{i\neq k} p_{N+1}^{(i)} \\ &amp;= -\frac{\partial p_{N+1}^{(k)}(z_{k}) / \partial z_{k}}{p_{N+1}^{(k)}(z_{k})} \\ &amp;=-\frac{(N+1)^{1/2}(N+1)^{1/2}f_{k}^{\star(N+1)\prime}((N+1)^{1/2}z_{k})}{(N+1)^{1/2}f_{k}^{\star(N+1)}((N+1)^{1/2}z_{k})}\\ &amp;= - (N+1)^{1/2} \frac{f^{\star(N+1)\prime}}{f^{\star(N+1)}}((N+1)^{1/2}z_{k}) \end{aligned}\] <p><strong>Right hand side</strong></p> <p>We note compute the score of \((N+1)^{1/2}Z_{N+1}^{(k)}=\sum_{j=1}^{N+1} X^{(k)}_{j}\) with respect to the joint density of \(Z_{N+1}^{(1)}, \ldots, (N+1)^{1/2}Z_{N+1}^{(k)}, \ldots, Z^{(k)}_{N+1}\)</p> <p>We note that the density of \((N+1)^{1/2}Z_{N+1}^{(k)}\) is simply</p> \[\rho_{N+1}^{(k)}(z_{k}) = (f_{k}^{\star(N+1)})(z_{k})\] <p>Then the joint density function is</p> \[p = \rho_{N+1}^{(k)}(z_{k})\prod_{i\neq k} p_{N+1}^{(i)}(z_{i})\] <p>Then we compute the score as follows</p> \[\begin{aligned} f((N+1)^{1/2}Z_{N+1}^{(k)} : Z_{N+1}^{(1)}, \ldots, (N+1)^{1/2}\hat{Z}^{(k)}_{N+1}, \ldots, Z^{(n)}_{N+1}) &amp;= - \frac{\partial p / \partial z_{k}}{p} \\ &amp;= - \frac{1}{\rho_{N+1}^{(k)}(z_{k})\prod_{i\neq k} p_{N+1}^{(i)}(z_{i})} \frac{\partial}{\partial z_{k}} \rho_{N+1}^{(k)}(z_{k}) \prod_{i\neq k} p_{N+1}^{(i)}(z_{i})\\ &amp;= -\frac{f^{\star(N+1)\prime}}{f^{\star(N+1)}}(z_{k}) \end{aligned}\] <h3 id="second-equality">Second equality</h3> <h3 id="third-equality">Third equality</h3> </div> </article> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> </body> </html>